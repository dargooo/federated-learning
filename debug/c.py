import os
import sys
import time
import socket
import pickle
from datetime import datetime
from copy import deepcopy
from threading import Thread, Lock
# from multiprocessing import Process, Pool, get_context, Queue
from queue import Queue

import torch
import torchvision
import torchvision.transforms as transforms
from torch.utils.data import DataLoader
import pandas as pd
import numpy as np

from models import CF10Net
from helper import ExperimentLogger, display_train_stats
from devices import *
from data_utils import split_data, CustomSubset

print("--> Creating client threads...")

model = """{'conv1.weight': tensor([[[[ 3.1099e-04,  4.9477e-04,  6.3637e-04,  7.2246e-04,  5.9210e-04],.
          [ 3.4130e-04,  5.0016e-04,  5.9041e-04,  6.0368e-04,  4.4796e-04], .
          [ 2.8183e-04,  4.6554e-04,  4.6328e-04,  3.8875e-04,  2.5485e-04],.
          [ 1.1042e-04,  3.4861e-04,  3.5094e-04,  2.2253e-04,  1.0201e-04],.
          [-3.3870e-05,  1.7188e-04,  2.4947e-04,  2.1676e-04,  1.1662e-04]].,.
         [[ 2.4073e-04,  4.2643e-04,  5.8116e-04,  6.8138e-04,  5.7275e-04],.
          [ 2.4653e-04,  4.1809e-04,  5.1641e-04,  5.3862e-04,  4.1262e-04],.
          [ 1.6794e-04,  3.8100e-04,  3.7830e-04,  3.1484e-04,  2.0890e-04],.
          [-1.0594e-05,  2.5619e-04,  2.5251e-04,  1.4059e-04,  4.3109e-05],.
          [-1.6499e-04,  6.0726e-05,  1.3402e-04,  1.2466e-04,  4.2699e-05]].,.
         [[ 3.3821e-04,  5.4043e-04,  7.0649e-04,  8.1960e-04,  7.2645e-04],.
          [ 3.1849e-04,  5.2419e-04,  6.3327e-04,  6.6935e-04,  5.5879e-04],.
          [ 2.4000e-04,  4.8531e-04,  4.9830e-04,  4.4533e-04,  3.4926e-04],.
          [ 6.8456e-05,  3.6334e-04,  3.7446e-04,  2.6534e-04,  1.7077e-04],.
          [-7.9982e-05,  1.5815e-04,  2.3479e-04,  2.3958e-04,  1.7194e-04]].].,
        [[[ 1.9028e-03,  2.0038e-03,  2.0370e-03,  2.0142e-03,  1.9061e-03],.
          [ 1.4936e-03,  1.5893e-03,  1.6548e-03,  1.6946e-03,  1.5724e-03],.
          [ 1.3750e-03,  1.2918e-03,  1.1339e-03,  9.7550e-04,  7.4101e-04],.
          [ 1.0928e-03,  9.3527e-04,  7.3016e-04,  4.8935e-04,  1.8320e-04],.
          [ 4.1638e-05, -1.9728e-04, -2.8148e-04, -1.8359e-04, -1.6531e-04]].,.
         [[ 3.0112e-03,  3.1600e-03,  3.1953e-03,  3.1468e-03,  2.9830e-03],.
          [ 2.4613e-03,  2.6070e-03,  2.6947e-03,  2.7435e-03,  2.5903e-03],.
          [ 2.2660e-03,  2.1986e-03,  2.0526e-03,  1.9061e-03,  1.6214e-03],.
          [ 1.8810e-03,  1.7095e-03,  1.5042e-03,  1.2817e-03,  9.3255e-04],.
          [ 7.0456e-04,  4.3733e-04,  3.3788e-04,  4.4623e-04,  4.5335e-04]].,.
         [[ 5.4611e-03,  5.6000e-03,  5.6199e-03,  5.5485e-03,  5.3607e-03],.
          [ 4.8705e-03,  4.9754e-03,  5.0299e-03,  5.0598e-03,  4.8840e-03],.
          [ 4.6175e-03,  4.5073e-03,  4.3160e-03,  4.1541e-03,  3.8458e-03],.
          [ 4.1656e-03,  3.9561e-03,  3.7030e-03,  3.4718e-03,  3.1147e-03],.
          [ 2.9649e-03,  2.6652e-03,  2.5118e-03,  2.6097e-03,  2.6145e-03]].].,
        [[[ 1.1497e-03,  1.2091e-03,  1.0597e-03,  8.8206e-04,  6.7303e-04],.
          [ 5.5909e-04,  5.7145e-04,  4.5048e-04,  2.9148e-04,  9.1918e-05],.
          [ 1.0816e-04,  1.6529e-04,  1.2890e-04, -4.7090e-05, -2.6706e-04],.
          [ 7.5541e-05,  2.2620e-04,  1.7597e-04, -4.2975e-05, -2.7587e-04],.
          [ 7.6769e-05,  7.7227e-05, -3.9678e-05, -2.5379e-04, -4.6399e-04]].,.
         [[ 7.4279e-04,  8.2061e-04,  6.9865e-04,  5.2010e-04,  3.2767e-04],.
          [ 2.1689e-04,  2.5129e-04,  1.5787e-04, -5.2676e-06, -1.9274e-04],.
          [-1.5519e-04, -1.0255e-04, -1.4041e-04, -3.1610e-04, -5.2850e-04],.
          [-1.5273e-04, -1.3337e-05, -7.6994e-05, -3.0086e-04, -5.3747e-04],.
          [-1.6022e-04, -1.6808e-04, -2.8998e-04, -5.2185e-04, -7.5409e-04]].,.
         [[ 4.1503e-05,  1.4365e-04,  5.7848e-05, -1.2067e-04, -3.3846e-04],.
          [-4.6017e-04, -4.1499e-04, -4.8966e-04, -6.5520e-04, -8.5688e-04],.
          [-8.2862e-04, -7.6394e-04, -7.9508e-04, -9.6387e-04, -1.1814e-03],.
          [-8.5877e-04, -7.1575e-04, -7.5836e-04, -9.5800e-04, -1.1959e-03],.
          [-8.7150e-04, -8.7367e-04, -9.7722e-04, -1.1964e-03, -1.4263e-03]].].,
        [[[ 6.5089e-04,  4.2249e-04,  3.5341e-04,  5.8395e-04,  8.5528e-04],.
          [ 8.9976e-04,  6.7129e-04,  4.4145e-04,  5.8180e-04,  8.2585e-04],.
          [ 6.2210e-04,  4.9117e-04,  3.2832e-04,  4.5219e-04,  6.3102e-04],.
          [ 1.6049e-04,  7.8082e-05,  3.7669e-05,  2.2591e-04,  3.3467e-04],.
          [ 6.8497e-05, -1.0568e-04, -1.6863e-04,  1.1547e-04,  2.9165e-04]].,.
         [[ 1.5493e-04, -8.6959e-05, -1.7857e-04,  4.9841e-05,  3.3451e-04],.
          [ 4.0453e-04,  1.7001e-04, -8.6977e-05,  5.5671e-05,  3.1271e-04],.
          [ 8.3387e-05, -5.1193e-05, -2.3081e-04, -9.3073e-05,  1.1453e-04],.
          [-3.8610e-04, -4.6979e-04, -5.2787e-04, -3.2054e-04, -1.7647e-04],.
          [-4.4939e-04, -6.1509e-04, -7.0478e-04, -4.1435e-04, -2.0354e-04]].,.
         [[ 8.0239e-04,  5.8369e-04,  5.3464e-04,  7.8554e-04,  1.0575e-03],.
          [ 1.0258e-03,  7.8658e-04,  5.6983e-04,  7.6821e-04,  1.0267e-03],.
          [ 7.3923e-04,  5.8258e-04,  4.0100e-04,  5.9266e-04,  8.3080e-04],.
          [ 3.0270e-04,  1.9633e-04,  1.0837e-04,  3.2441e-04,  5.0829e-04],.
          [ 2.1721e-04,  3.9633e-05, -6.3706e-05,  2.0904e-04,  4.3066e-04]].].,
        [[[-1.2798e-03, -1.1305e-03, -6.9521e-04, -4.8855e-04, -4.1032e-04],.
          [-1.2485e-03, -1.1659e-03, -8.0474e-04, -5.9504e-04, -5.5024e-04],.
          [-1.0471e-03, -1.0132e-03, -7.2946e-04, -5.7861e-04, -4.6711e-04],.
          [-6.9666e-04, -7.0783e-04, -5.0032e-04, -3.8650e-04, -2.1406e-04],.
          [-3.1752e-04, -2.8748e-04, -1.6745e-04, -1.2530e-04,  6.0447e-05]].,.
         [[-1.8128e-03, -1.6455e-03, -1.1828e-03, -9.7872e-04, -9.1680e-04],.
          [-1.7297e-03, -1.6472e-03, -1.2915e-03, -1.0851e-03, -1.0447e-03],.
          [-1.5159e-03, -1.4974e-03, -1.2257e-03, -1.0922e-03, -9.7259e-04],.
          [-1.1776e-03, -1.2026e-03, -1.0240e-03, -9.1052e-04, -7.1458e-04],.
          [-8.2722e-04, -7.9595e-04, -7.0793e-04, -6.7065e-04, -4.5132e-04]].,.
         [[-1.7109e-03, -1.5175e-03, -1.0835e-03, -9.1725e-04, -8.6647e-04],.
          [-1.6184e-03, -1.4834e-03, -1.1409e-03, -9.7637e-04, -9.4587e-04],.
          [-1.4052e-03, -1.3275e-03, -1.0464e-03, -9.4239e-04, -8.3493e-04],.
          [-1.0811e-03, -1.0554e-03, -8.5925e-04, -7.6610e-04, -5.8752e-04],.
          [-7.4597e-04, -6.7537e-04, -5.8286e-04, -5.4791e-04, -3.3935e-04]].].,
        [[[ 6.1662e-04,  6.3582e-04,  5.4318e-04,  3.5167e-04,  2.1581e-04],.
          [ 8.0794e-04,  7.2448e-04,  4.4240e-04,  1.2087e-04, -1.4113e-04],.
          [ 8.3820e-04,  5.8269e-04,  3.3021e-04,  1.0063e-04, -2.7284e-04],.
          [ 7.9595e-04,  6.5187e-04,  4.3529e-04,  9.8020e-05, -2.0244e-04],.
          [ 7.9484e-04,  6.2291e-04,  5.0987e-04,  2.2141e-04, -1.4382e-04]].,.
         [[ 3.0971e-04,  2.7558e-04,  1.5842e-04,  7.9945e-06, -8.7235e-05],.
          [ 4.7329e-04,  3.6110e-04,  5.4434e-05, -2.3926e-04, -4.3065e-04],.
          [ 5.1883e-04,  2.3741e-04, -5.4024e-05, -2.8686e-04, -5.6863e-04],.
          [ 4.9310e-04,  3.0295e-04,  4.6924e-05, -2.9623e-04, -5.2336e-04],.
          [ 5.5204e-04,  3.5001e-04,  2.0195e-04, -1.1295e-04, -4.3812e-04]].,.
         [[ 1.4821e-03,  1.4188e-03,  1.2765e-03,  1.1439e-03,  1.1057e-03],.
          [ 1.6134e-03,  1.5022e-03,  1.2039e-03,  9.4801e-04,  8.0994e-04],.
          [ 1.6403e-03,  1.4050e-03,  1.1459e-03,  9.3970e-04,  6.9193e-04],.
          [ 1.6264e-03,  1.4945e-03,  1.2729e-03,  9.6506e-04,  7.7951e-04],.
          [ 1.7119e-03,  1.5626e-03,  1.4364e-03,  1.1612e-03,  9.1629e-04]].].]), 'conv1.bias': tensor([ 0.0001,  0.0058, -0.0012, -0.0013, -0.0013, -0.0015]), 'conv2.weight': tensor([[[[-3.0815e-04, -3.8905e-04, -3.4366e-04, -3.2502e-04, -3.6030e-04],.
          [-2.6480e-04, -3.2768e-04, -3.4510e-04, -3.9860e-04, -3.2513e-04],.
          [-3.7606e-04, -4.0256e-04, -4.4394e-04, -5.3900e-04, -4.3584e-04],.
          [-4.1375e-04, -4.7358e-04, -4.3384e-04, -4.5394e-04, -4.6111e-04],.
          [-3.3557e-04, -3.4318e-04, -3.7845e-04, -2.9881e-04, -3.0582e-04]].,.
         [[-1.8397e-03, -1.9383e-03, -2.0527e-03, -2.0505e-03, -2.0681e-03],.
          [-1.8083e-03, -1.9118e-03, -1.9522e-03, -1.9368e-03, -1.8549e-03],.
          [-1.6304e-03, -1.7345e-03, -1.7657e-03, -1.7386e-03, -1.6200e-03],.
          [-1.7026e-03, -1.7926e-03, -1.7380e-03, -1.7767e-03, -1.7142e-03],.
          [-2.0392e-03, -1.9824e-03, -1.8618e-03, -1.7328e-03, -1.7581e-03]].,.
         [[-9.4622e-07, -6.4522e-06, -3.6284e-05, -2.1018e-05, -3.0495e-05],.
          [-2.3618e-06,  2.9281e-06, -3.8929e-05, -7.4476e-05, -6.6130e-05],.
          [-1.3638e-04, -1.2421e-04, -1.1444e-04, -1.5131e-04, -1.3190e-04],.
          [-2.8180e-04, -3.1551e-04, -2.5374e-04, -2.0839e-04, -1.9536e-04],.
          [-2.2548e-04, -2.2115e-04, -1.8897e-04, -1.5856e-04, -1.5426e-04]].,.
         [[-3.6321e-04, -2.2590e-04, -1.6744e-04, -2.6003e-04, -2.1764e-04],.
          [-3.4739e-04, -3.3325e-04, -2.7005e-04, -2.1798e-04, -3.8100e-04],.
          [-6.7198e-04, -6.6803e-04, -7.4156e-04, -6.6040e-04, -4.8972e-04],.
          [-6.0286e-04, -5.6799e-04, -6.0796e-04, -6.6068e-04, -4.3105e-04],.
          [-2.2537e-04, -3.0361e-04, -1.7491e-04, -1.4177e-04, -1.4259e-04]].,.
         [[-8.1658e-05,  1.4938e-06,  1.0246e-04,  1.6278e-04,  1.7771e-04],.
          [-6.9262e-05, -7.1745e-05,  3.9395e-05,  1.5380e-04,  1.9997e-04],.
          [ 1.3633e-04,  1.3511e-04,  1.1189e-04,  1.8795e-04,  2.4508e-04],.
          [ 1.1212e-04,  1.0932e-04,  3.7396e-05, -1.5374e-05, -7.1377e-06],.
          [-2.3847e-04, -3.0182e-04, -3.3326e-04, -3.5610e-04, -3.0521e-04]].,.
         [[ 5.9808e-04,  7.5739e-04,  8.5681e-04,  7.3669e-04,  7.3773e-04],.
          [ 6.0682e-04,  8.3346e-04,  7.9430e-04,  5.6829e-04,  4.8939e-04],.
          [ 3.0029e-04,  3.9693e-04,  3.4455e-04,  2.7467e-04,  1.6976e-04],.
          [ 1.0103e-04,  1.5007e-04,  1.7154e-04,  2.2765e-04,  2.1945e-04],.
          [ 3.2108e-04,  3.5550e-04,  4.5390e-04,  4.9424e-04,  4.6988e-04]].].,
        [[[ 6.7819e-04,  6.4636e-04,  7.3011e-04,  7.7142e-04,  7.7453e-04],.
          [ 6.6938e-04,  8.2107e-04,  8.2409e-04,  7.8655e-04,  7.9590e-04],.
          [ 7.0465e-04,  7.7025e-04,  7.5833e-04,  7.7494e-04,  8.7968e-04],.
          [ 5.0863e-04,  6.0506e-04,  6.9001e-04,  7.2078e-04,  7.7138e-04],.
          [ 3.0813e-04,  3.6632e-04,  5.2058e-04,  4.7129e-04,  5.0751e-04]].,.
         [[ 1.9753e-03,  1.9616e-03,  2.0263e-03,  2.1135e-03,  2.1350e-03],.
          [ 1.9412e-03,  2.1224e-03,  2.2563e-03,  2.3351e-03,  2.3006e-03],.
          [ 2.3082e-03,  2.4869e-03,  2.3759e-03,  2.3714e-03,  2.4134e-03],.
          [ 2.1742e-03,  2.1575e-03,  2.2646e-03,  2.3294e-03,  2.3494e-03],.
          [ 1.9487e-03,  2.0904e-03,  2.2591e-03,  2.3720e-03,  2.3882e-03]].,.
         [[ 1.0400e-04,  1.4450e-04,  2.0401e-04,  2.2132e-04,  2.3237e-04],.
          [ 1.3011e-04,  1.8668e-04,  2.2094e-04,  2.2764e-04,  2.4634e-04],.
          [ 7.1939e-05,  1.2018e-04,  1.2938e-04,  1.0622e-04,  1.3923e-04],.
          [ 8.0626e-05,  7.8075e-05,  9.4213e-05,  7.9416e-05,  5.5697e-05],.
          [ 8.4251e-05,  9.0843e-05,  6.0789e-05,  4.2498e-05, -8.5644e-06]].,.
         [[ 4.1056e-04,  5.2530e-04,  7.5478e-04,  7.3252e-04,  7.7592e-04],.
          [ 3.9540e-04,  3.7509e-04,  4.2847e-04,  5.5998e-04,  4.8736e-04],.
          [ 3.7130e-04,  3.4536e-04,  2.9062e-04,  5.0063e-04,  5.0859e-04],.
          [ 3.8055e-04,  5.1775e-04,  5.8796e-04,  6.5540e-04,  6.1011e-04],.
          [ 1.5585e-04,  2.3101e-04,  2.0838e-04,  1.7193e-04,  1.3092e-04]].,.
         [[-3.9245e-04, -5.2403e-04, -4.9563e-04, -3.8760e-04, -3.5080e-04],.
          [-4.2112e-04, -4.4237e-04, -4.3125e-04, -2.0666e-04, -1.8644e-04],.
          [-2.4898e-04, -1.3614e-04, -2.0624e-04, -1.1110e-04,  7.4908e-05],.
          [-2.5005e-04, -2.4242e-04, -3.1681e-04, -2.2408e-04, -4.1425e-06],.
          [-2.2057e-04, -2.3555e-04, -1.8238e-04,  9.6671e-06,  2.0328e-04]].,.
         [[-1.1098e-03, -9.4549e-04, -8.6142e-04, -7.9752e-04, -5.8810e-04],.
          [-1.0370e-03, -1.0824e-03, -1.0268e-03, -1.1368e-03, -9.3099e-04],.
          [-1.0540e-03, -1.2319e-03, -1.2035e-03, -1.1656e-03, -1.2493e-03],.
          [-8.4296e-04, -8.7446e-04, -9.9508e-04, -1.0049e-03, -1.1031e-03],.
          [-8.2961e-04, -8.5366e-04, -1.0386e-03, -1.2194e-03, -1.1050e-03]].].,
        [[[ 1.2038e-03,  1.1893e-03,  1.0372e-03,  9.4838e-04,  9.5047e-04],.
          [ 9.8797e-04,  9.3791e-04,  8.3657e-04,  8.5375e-04,  7.5412e-04],.
          [ 6.0665e-04,  6.2191e-04,  6.4245e-04,  4.9575e-04,  6.5190e-04],.
          [ 4.1902e-04,  4.7678e-04,  4.6167e-04,  4.6178e-04,  4.7279e-04],.
          [ 2.1978e-04,  3.0844e-04,  3.1317e-04,  3.2957e-04,  2.9800e-04]].,.
         [[ 3.3957e-03,  3.4592e-03,  3.4151e-03,  3.4197e-03,  3.3759e-03],.
          [ 3.5455e-03,  3.6116e-03,  3.4806e-03,  3.3915e-03,  3.0907e-03],.
          [ 3.1458e-03,  3.0635e-03,  2.8700e-03,  2.6674e-03,  2.6126e-03],.
          [ 2.4704e-03,  2.3384e-03,  2.1430e-03,  2.1780e-03,  2.2178e-03],.
          [ 1.7779e-03,  1.7717e-03,  1.7606e-03,  1.6743e-03,  1.5917e-03]].,.
         [[ 1.6754e-04,  2.2229e-04,  2.6000e-04,  2.4957e-04,  2.4195e-04],.
          [ 9.2234e-05,  1.3067e-04,  1.3197e-04,  1.5278e-04,  1.6198e-04],.
          [ 9.8780e-05,  1.0260e-04,  1.1564e-04,  9.3274e-05,  8.2478e-05],.
          [ 1.2489e-04,  9.8336e-05,  9.4756e-05,  8.3573e-05,  9.5918e-05],.
          [ 2.2943e-04,  1.5665e-04,  1.1984e-04,  1.4627e-04,  1.5598e-04]].,.
         [[ 9.4543e-04,  8.5846e-04,  8.2712e-04,  8.8285e-04,  8.6374e-04],.
          [ 8.4270e-04,  7.9790e-04,  7.9976e-04,  6.7746e-04,  6.5519e-04],.
          [ 6.4640e-04,  5.7816e-04,  6.2751e-04,  7.3241e-04,  6.4247e-04],.
          [ 8.5484e-04,  6.9478e-04,  5.9333e-04,  5.5002e-04,  5.9455e-04],.
          [ 7.8016e-04,  6.7322e-04,  5.8459e-04,  4.2341e-04,  4.5132e-04]].,.
         [[ 7.8649e-04,  7.5771e-04,  8.0464e-04,  8.5495e-04,  9.0513e-04],.
          [ 1.1853e-03,  1.2576e-03,  1.2689e-03,  1.2759e-03,  1.1892e-03],.
          [ 1.4037e-03,  1.3728e-03,  1.1994e-03,  1.1051e-03,  1.0303e-03],.
          [ 1.0489e-03,  1.0623e-03,  8.7424e-04,  8.8195e-04,  9.5754e-04],.
          [ 6.1356e-04,  7.0052e-04,  7.3030e-04,  7.4425e-04,  6.8369e-04]].,.
         [[ 3.3759e-05,  6.0506e-05,  1.3630e-04,  1.3336e-04,  2.0184e-04],.
          [ 4.4525e-05, -2.0705e-05,  4.1470e-05,  5.5647e-05,  1.4504e-04],.
          [ 7.8529e-05,  5.7556e-05,  9.6057e-05,  1.8604e-04,  2.2729e-04],.
          [ 4.1109e-04,  3.4217e-04,  2.8845e-04,  3.2457e-04,  2.6726e-04],.
          [ 6.9151e-04,  5.9125e-04,  5.1237e-04,  4.6078e-04,  5.0100e-04]].].,
        ...,.
        [[[ 4.6553e-04,  4.5442e-04,  5.6195e-04,  4.6995e-04,  4.5341e-04],.
          [ 4.0204e-04,  4.2130e-04,  5.4684e-04,  5.5798e-04,  4.0573e-04],.
          [ 3.3910e-04,  3.7648e-04,  5.2342e-04,  5.6720e-04,  3.5032e-04],.
          [ 2.7529e-04,  2.9042e-04,  4.9088e-04,  4.7929e-04,  3.1423e-04],.
          [ 2.2377e-04,  3.1435e-04,  3.9541e-04,  3.7031e-04,  2.7882e-04]].,.
         [[ 1.0473e-03,  1.0639e-03,  1.0983e-03,  9.9878e-04,  1.0244e-03],.
          [ 1.1902e-03,  1.1991e-03,  1.2793e-03,  1.1590e-03,  1.1273e-03],.
          [ 1.2280e-03,  1.2077e-03,  1.2534e-03,  1.2461e-03,  1.1516e-03],.
          [ 1.2013e-03,  1.1953e-03,  1.2893e-03,  1.2810e-03,  1.1994e-03],.
          [ 1.2346e-03,  1.1623e-03,  1.2537e-03,  1.2154e-03,  1.2139e-03]].,.
         [[ 1.2076e-05, -8.4280e-06, -1.3411e-07,  1.4445e-05, -5.3501e-05],.
          [ 1.3806e-05, -2.1977e-05, -2.7880e-05,  3.0480e-05, -3.6879e-05],.
          [ 6.2436e-06, -2.3812e-05, -3.3579e-05,  7.1990e-05,  2.5949e-05],.
          [ 1.9252e-05, -2.0547e-05, -4.6048e-05,  2.5302e-05,  2.7701e-05],.
          [-1.9820e-05, -5.9851e-05, -9.4578e-05, -4.9233e-05, -3.3360e-05]].,.
         [[ 2.7709e-04,  2.5231e-04,  9.1787e-05,  1.2717e-04,  2.2188e-04],.
          [ 1.4155e-04,  1.4740e-04,  1.6637e-04,  4.3748e-05,  1.9759e-04],.
          [ 1.4248e-04,  2.2078e-04,  2.4880e-04,  1.1950e-04,  2.4228e-04],.
          [ 1.8083e-05,  2.2915e-04,  2.7869e-04,  1.2863e-04,  1.1839e-04],.
          [ 1.7850e-04,  2.1411e-04,  3.2268e-04,  1.3324e-04,  1.2630e-04]].,.
         [[-1.4305e-06,  6.5327e-05,  1.0222e-04,  1.5490e-05, -5.4818e-06],.
          [ 2.1452e-04,  2.5241e-04,  3.3125e-04,  1.4798e-04,  1.0153e-04],.
          [ 3.3625e-04,  3.6592e-04,  4.5146e-04,  2.8509e-04,  7.0879e-05],.
          [ 3.6564e-04,  3.7877e-04,  5.5174e-04,  4.8108e-04,  2.6217e-04],.
          [ 4.3749e-04,  4.7102e-04,  6.5718e-04,  5.8078e-04,  4.1686e-04]].,.
         [[-1.4421e-04, -2.9223e-04, -2.3664e-04, -1.3052e-04, -2.8881e-04],.
          [-2.7755e-04, -3.5578e-04, -3.0946e-04, -1.8482e-04, -2.3547e-04],.
          [-2.2470e-04, -2.2640e-04, -2.4643e-04, -1.6779e-04,  4.5337e-06],.
          [-1.6897e-04, -1.4505e-04, -2.5560e-04, -3.1208e-04, -1.2513e-04],.
          [-2.7219e-04, -1.5667e-04, -3.0050e-04, -3.5986e-04, -2.5458e-04]].].,
        [[[ 5.9158e-06, -8.6054e-07,  6.5919e-06,  7.7747e-06,  1.1399e-06],.
          [ 2.1495e-06,  1.2730e-06,  2.3954e-06,  5.5358e-06,  3.1963e-06],.
          [ 9.7789e-07,  6.5565e-07, -3.5018e-07,  2.0266e-06,  3.7774e-06],.
          [-5.6624e-07, -1.1995e-06, -2.4028e-06,  2.4438e-06,  3.5372e-06],.
          [ 3.0212e-06,  2.4959e-07, -1.0207e-06, -1.4305e-06,  2.9318e-06]].,.
         [[ 1.8814e-05,  1.4257e-05,  1.7777e-05,  1.6827e-05,  1.8976e-05],.
          [ 1.5946e-05,  1.1886e-05,  9.5665e-06,  9.9447e-06,  8.5905e-06],.
          [ 1.4786e-05,  5.7044e-06,  2.7791e-06,  1.0341e-05,  4.9453e-06],.
          [ 9.4883e-06,  1.7881e-06,  6.0126e-06,  7.4003e-06,  1.1852e-05],.
          [ 1.0196e-05, -5.7044e-07,  1.8775e-06,  2.2762e-06,  6.6236e-06]].,.
         [[ 2.5716e-06, -8.9407e-08, -1.1101e-06,  3.3714e-07, -2.0862e-06],.
          [ 1.1921e-06,  3.3155e-07,  2.3842e-07, -1.6764e-06,  7.2271e-07],.
          [ 4.0233e-06,  1.2405e-06, -2.0694e-06, -3.0175e-06,  9.6485e-07],.
          [ 8.7917e-06,  2.7157e-06,  2.4913e-07, -1.5311e-06, -1.7136e-07],.
          [ 8.7470e-06,  4.8596e-06,  4.2096e-06,  3.8370e-07, -1.5497e-06]].,.
         [[ 4.3213e-07,  6.7391e-06,  7.4953e-06,  2.2091e-06,  5.0589e-06],.
          [ 3.0370e-06,  3.2112e-06,  7.3500e-06,  4.7199e-06, -6.9570e-07],.
          [ 9.1568e-06,  1.0487e-05,  9.1419e-06,  9.8767e-06, -2.3581e-06],.
          [-2.7772e-06,  6.4559e-06,  9.0189e-06,  1.3679e-05, -2.7008e-06],.
          [ 4.6045e-06,  2.9802e-06,  7.0557e-06,  1.8062e-05,  2.1530e-05]].,.
          [-5.4911e-06, -6.8322e-06,  1.0226e-06,  1.8805e-05,  9.2573e-06],.
          [-3.3602e-06, -6.1207e-06, -5.8562e-06,  7.2420e-06,  9.5991e-06],.
          [-2.1234e-06, -9.2131e-06, -9.3803e-06, -3.2857e-06,  1.8068e-06]].,.
         [[ 3.9618e-06,  5.7966e-06,  5.4799e-06,  6.5756e-06,  1.0327e-05],.
          [ 6.1840e-07,  4.7125e-06,  2.2650e-06,  4.2841e-06,  9.0748e-06],.
          [ 6.7540e-06,  6.0927e-06,  5.7984e-06,  8.2329e-07,  1.1083e-06],.
          [ 1.4462e-05,  1.4350e-05,  6.3553e-06,  3.4682e-06, -6.4075e-06],.
          [ 8.2832e-06,  1.8138e-05,  1.7002e-05,  2.1316e-05,  1.3053e-05]].].,
        [[[ 6.0759e-06,  1.2703e-06,  1.4566e-06,  5.9349e-07, -3.0484e-05],.
          [ 8.9128e-07,  1.0431e-07,  4.6566e-07, -2.3991e-06, -3.6467e-05],.
          [ 5.6000e-06, -3.6582e-06, -2.9393e-06, -1.8096e-05, -3.3300e-05],.
          [ 6.0275e-06, -1.0154e-05, -2.5801e-05, -4.4640e-05, -4.9021e-05],.
          [ 2.4140e-06, -2.9360e-05, -4.3897e-05, -4.7520e-05, -4.4497e-05]].,.
         [[-2.5107e-05,  1.3058e-05,  2.6226e-05, -5.1484e-06, -5.0552e-06],.
          [-1.7785e-05,  2.2911e-05,  3.1631e-05,  1.2945e-05,  6.1998e-06],.
          [-1.9969e-05,  1.9386e-05,  3.0935e-05,  2.3551e-05, -1.0673e-06],.
          [ 7.5307e-06,  1.8857e-05,  7.4469e-06, -1.6890e-05, -2.6315e-05],.
          [ 3.7365e-05,  2.8867e-05,  1.2012e-05, -5.0217e-06, -1.9737e-05]].,.
         [[ 4.6790e-06,  1.5870e-06, -1.9122e-06,  2.8582e-06, -1.1602e-05],.
          [ 4.7442e-06,  6.9290e-06,  6.1095e-07, -9.0078e-06, -3.8520e-06],.
          [ 2.4290e-05,  2.2174e-05,  1.1630e-05, -1.1291e-05,  1.2171e-05],.
          [ 2.6161e-05,  4.1571e-05,  5.5730e-05,  1.7833e-05,  2.7493e-05],.
          [-5.5432e-06, -1.7500e-06,  1.0585e-05,  1.2681e-05,  9.5563e-06]].,.
         [[-1.8567e-05, -8.3074e-07, -7.4878e-06, -5.0221e-05, -2.2938e-05],.
          [-2.1480e-05,  3.4173e-05,  4.7944e-06, -4.1056e-05, -8.3670e-05],.
          [-9.0711e-06,  3.7812e-05,  3.9192e-05,  1.7319e-05, -8.0161e-05],.
          [-2.6062e-05,  7.7486e-06, -1.2180e-05, -1.4707e-05, -3.1032e-05],.
          [-6.6865e-05, -5.8104e-05, -4.7207e-05, -6.1452e-05, -6.8678e-05]].,.
         [[-1.0278e-05, -6.6143e-06, -7.4245e-06, -1.8407e-05, -6.2134e-05],.
          [-1.5967e-05, -1.1018e-05, -1.0037e-06, -2.6673e-06, -4.0412e-05],.
          [-1.2938e-05, -1.7211e-05, -4.5933e-06, -3.6657e-06, -3.9186e-05],.
          [ 2.5235e-05,  8.4597e-06,  3.8743e-06, -8.6837e-06, -2.6498e-05],.
          [ 5.0485e-05,  2.3201e-05,  7.4282e-06,  4.4075e-07, -1.1649e-05]].,.
         [[-1.8257e-04, -1.9757e-04, -1.9773e-04, -1.5651e-04, -1.4299e-04],.
          [-1.4981e-04, -9.6899e-05, -1.4102e-04, -1.9650e-04, -1.9540e-04],.
          [-4.2990e-05,  1.0766e-05, -4.3470e-05, -1.3883e-04, -1.2934e-04],.
           [ 3.4130e-04,  5.0016e-04,  5.9041e-04,  6.0368e-04,  4.4796e-04], .
          [ 2.8183e-04,  4.6554e-04,  4.6328e-04,  3.8875e-04,  2.5485e-04],.
          [ 1.1042e-04,  3.4861e-04,  3.5094e-04,  2.2253e-04,  1.0201e-04],.
          [-3.3870e-05,  1.7188e-04,  2.4947e-04,  2.1676e-04,  1.1662e-04]].,.
         [[ 2.4073e-04,  4.2643e-04,  5.8116e-04,  6.8138e-04,  5.7275e-04],.
          [ 2.4653e-04,  4.1809e-04,  5.1641e-04,  5.3862e-04,  4.1262e-04],.
          [ 1.6794e-04,  3.8100e-04,  3.7830e-04,  3.1484e-04,  2.0890e-04],.
          [-1.0594e-05,  2.5619e-04,  2.5251e-04,  1.4059e-04,  4.3109e-05],.
          [-1.6499e-04,  6.0726e-05,  1.3402e-04,  1.2466e-04,  4.2699e-05]].,.
         [[ 3.3821e-04,  5.4043e-04,  7.0649e-04,  8.1960e-04,  7.2645e-04],.
          [ 3.1849e-04,  5.2419e-04,  6.3327e-04,  6.6935e-04,  5.5879e-04],.
          [ 2.4000e-04,  4.8531e-04,  4.9830e-04,  4.4533e-04,  3.4926e-04],.
          [ 6.8456e-05,  3.6334e-04,  3.7446e-04,  2.6534e-04,  1.7077e-04],.
          [-7.9982e-05,  1.5815e-04,  2.3479e-04,  2.3958e-04,  1.7194e-04]].].,
        [[[ 1.9028e-03,  2.0038e-03,  2.0370e-03,  2.0142e-03,  1.9061e-03],.
          [ 1.4936e-03,  1.5893e-03,  1.6548e-03,  1.6946e-03,  1.5724e-03],.
          [ 1.3750e-03,  1.2918e-03,  1.1339e-03,  9.7550e-04,  7.4101e-04],.
          [ 1.0928e-03,  9.3527e-04,  7.3016e-04,  4.8935e-04,  1.8320e-04],.
          [ 4.1638e-05, -1.9728e-04, -2.8148e-04, -1.8359e-04, -1.6531e-04]].,.
         [[ 3.0112e-03,  3.1600e-03,  3.1953e-03,  3.1468e-03,  2.9830e-03],.
          [ 2.4613e-03,  2.6070e-03,  2.6947e-03,  2.7435e-03,  2.5903e-03],.
          [ 2.2660e-03,  2.1986e-03,  2.0526e-03,  1.9061e-03,  1.6214e-03],.
          [ 1.8810e-03,  1.7095e-03,  1.5042e-03,  1.2817e-03,  9.3255e-04],.
          [ 7.0456e-04,  4.3733e-04,  3.3788e-04,  4.4623e-04,  4.5335e-04]].,.
         [[ 5.4611e-03,  5.6000e-03,  5.6199e-03,  5.5485e-03,  5.3607e-03],.
          [ 4.8705e-03,  4.9754e-03,  5.0299e-03,  5.0598e-03,  4.8840e-03],.
          [ 4.6175e-03,  4.5073e-03,  4.3160e-03,  4.1541e-03,  3.8458e-03],.
          [ 4.1656e-03,  3.9561e-03,  3.7030e-03,  3.4718e-03,  3.1147e-03],.
          [ 2.9649e-03,  2.6652e-03,  2.5118e-03,  2.6097e-03,  2.6145e-03]].].,
        [[[ 1.1497e-03,  1.2091e-03,  1.0597e-03,  8.8206e-04,  6.7303e-04],.
          [ 5.5909e-04,  5.7145e-04,  4.5048e-04,  2.9148e-04,  9.1918e-05],.
          [ 1.0816e-04,  1.6529e-04,  1.2890e-04, -4.7090e-05, -2.6706e-04],.
          [ 7.5541e-05,  2.2620e-04,  1.7597e-04, -4.2975e-05, -2.7587e-04],.
          [ 7.6769e-05,  7.7227e-05, -3.9678e-05, -2.5379e-04, -4.6399e-04]].,.
         [[ 7.4279e-04,  8.2061e-04,  6.9865e-04,  5.2010e-04,  3.2767e-04],.
          [ 2.1689e-04,  2.5129e-04,  1.5787e-04, -5.2676e-06, -1.9274e-04],.
          [-1.5519e-04, -1.0255e-04, -1.4041e-04, -3.1610e-04, -5.2850e-04],.
          [-1.5273e-04, -1.3337e-05, -7.6994e-05, -3.0086e-04, -5.3747e-04],.
          [-1.6022e-04, -1.6808e-04, -2.8998e-04, -5.2185e-04, -7.5409e-04]].,.
         [[ 4.1503e-05,  1.4365e-04,  5.7848e-05, -1.2067e-04, -3.3846e-04],.
          [-4.6017e-04, -4.1499e-04, -4.8966e-04, -6.5520e-04, -8.5688e-04],.
          [-8.2862e-04, -7.6394e-04, -7.9508e-04, -9.6387e-04, -1.1814e-03],.
          [-8.5877e-04, -7.1575e-04, -7.5836e-04, -9.5800e-04, -1.1959e-03],.
          [-8.7150e-04, -8.7367e-04, -9.7722e-04, -1.1964e-03, -1.4263e-03]].].,
        [[[ 6.5089e-04,  4.2249e-04,  3.5341e-04,  5.8395e-04,  8.5528e-04],.
          [ 8.9976e-04,  6.7129e-04,  4.4145e-04,  5.8180e-04,  8.2585e-04],.
          [ 6.2210e-04,  4.9117e-04,  3.2832e-04,  4.5219e-04,  6.3102e-04],.
          [ 1.6049e-04,  7.8082e-05,  3.7669e-05,  2.2591e-04,  3.3467e-04],.
          [ 6.8497e-05, -1.0568e-04, -1.6863e-04,  1.1547e-04,  2.9165e-04]].,.
         [[ 1.5493e-04, -8.6959e-05, -1.7857e-04,  4.9841e-05,  3.3451e-04],.
          [ 4.0453e-04,  1.7001e-04, -8.6977e-05,  5.5671e-05,  3.1271e-04],.
          [ 8.3387e-05, -5.1193e-05, -2.3081e-04, -9.3073e-05,  1.1453e-04],.
          [-3.8610e-04, -4.6979e-04, -5.2787e-04, -3.2054e-04, -1.7647e-04],.
          [-4.4939e-04, -6.1509e-04, -7.0478e-04, -4.1435e-04, -2.0354e-04]].,.
         [[ 8.0239e-04,  5.8369e-04,  5.3464e-04,  7.8554e-04,  1.0575e-03],.
          [ 1.0258e-03,  7.8658e-04,  5.6983e-04,  7.6821e-04,  1.0267e-03],.
          [ 7.3923e-04,  5.8258e-04,  4.0100e-04,  5.9266e-04,  8.3080e-04],.
          [ 3.0270e-04,  1.9633e-04,  1.0837e-04,  3.2441e-04,  5.0829e-04],.
          [ 2.1721e-04,  3.9633e-05, -6.3706e-05,  2.0904e-04,  4.3066e-04]].].,
        [[[-1.2798e-03, -1.1305e-03, -6.9521e-04, -4.8855e-04, -4.1032e-04],.
          [-1.2485e-03, -1.1659e-03, -8.0474e-04, -5.9504e-04, -5.5024e-04],.
          [-1.0471e-03, -1.0132e-03, -7.2946e-04, -5.7861e-04, -4.6711e-04],.
          [-6.9666e-04, -7.0783e-04, -5.0032e-04, -3.8650e-04, -2.1406e-04],.
          [-3.1752e-04, -2.8748e-04, -1.6745e-04, -1.2530e-04,  6.0447e-05]].,.
         [[-1.8128e-03, -1.6455e-03, -1.1828e-03, -9.7872e-04, -9.1680e-04],.
          [-1.7297e-03, -1.6472e-03, -1.2915e-03, -1.0851e-03, -1.0447e-03],.
          [-1.5159e-03, -1.4974e-03, -1.2257e-03, -1.0922e-03, -9.7259e-04],.
          [-1.1776e-03, -1.2026e-03, -1.0240e-03, -9.1052e-04, -7.1458e-04],.
          [-8.2722e-04, -7.9595e-04, -7.0793e-04, -6.7065e-04, -4.5132e-04]].,.
         [[-1.7109e-03, -1.5175e-03, -1.0835e-03, -9.1725e-04, -8.6647e-04],.
          [-1.6184e-03, -1.4834e-03, -1.1409e-03, -9.7637e-04, -9.4587e-04],.
          [-1.4052e-03, -1.3275e-03, -1.0464e-03, -9.4239e-04, -8.3493e-04],.
          [-1.0811e-03, -1.0554e-03, -8.5925e-04, -7.6610e-04, -5.8752e-04],.
          [-7.4597e-04, -6.7537e-04, -5.8286e-04, -5.4791e-04, -3.3935e-04]].].,
        [[[ 6.1662e-04,  6.3582e-04,  5.4318e-04,  3.5167e-04,  2.1581e-04],.
          [ 8.0794e-04,  7.2448e-04,  4.4240e-04,  1.2087e-04, -1.4113e-04],.
          [ 8.3820e-04,  5.8269e-04,  3.3021e-04,  1.0063e-04, -2.7284e-04],.
          [ 7.9595e-04,  6.5187e-04,  4.3529e-04,  9.8020e-05, -2.0244e-04],.
          [ 7.9484e-04,  6.2291e-04,  5.0987e-04,  2.2141e-04, -1.4382e-04]].,.
         [[ 3.0971e-04,  2.7558e-04,  1.5842e-04,  7.9945e-06, -8.7235e-05],.
          [ 4.7329e-04,  3.6110e-04,  5.4434e-05, -2.3926e-04, -4.3065e-04],.
          [ 5.1883e-04,  2.3741e-04, -5.4024e-05, -2.8686e-04, -5.6863e-04],.
          [ 4.9310e-04,  3.0295e-04,  4.6924e-05, -2.9623e-04, -5.2336e-04],.
          [ 5.5204e-04,  3.5001e-04,  2.0195e-04, -1.1295e-04, -4.3812e-04]].,.
         [[ 1.4821e-03,  1.4188e-03,  1.2765e-03,  1.1439e-03,  1.1057e-03],.
          [ 1.6134e-03,  1.5022e-03,  1.2039e-03,  9.4801e-04,  8.0994e-04],.
          [ 1.6403e-03,  1.4050e-03,  1.1459e-03,  9.3970e-04,  6.9193e-04],.
          [ 1.6264e-03,  1.4945e-03,  1.2729e-03,  9.6506e-04,  7.7951e-04],.
          [ 1.7119e-03,  1.5626e-03,  1.4364e-03,  1.1612e-03,  9.1629e-04]].].]), 'conv1.bias': tensor([ 0.0001,  0.0058, -0.0012, -0.0013, -0.0013, -0.0015]), 'conv2.weight': tensor([[[[-3.0815e-04, -3.8905e-04, -3.4366e-04, -3.2502e-04, -3.6030e-04],.
          [-2.6480e-04, -3.2768e-04, -3.4510e-04, -3.9860e-04, -3.2513e-04],.
          [-3.7606e-04, -4.0256e-04, -4.4394e-04, -5.3900e-04, -4.3584e-04],.
          [-4.1375e-04, -4.7358e-04, -4.3384e-04, -4.5394e-04, -4.6111e-04],.
          [-3.3557e-04, -3.4318e-04, -3.7845e-04, -2.9881e-04, -3.0582e-04]].,.
         [[-1.8397e-03, -1.9383e-03, -2.0527e-03, -2.0505e-03, -2.0681e-03],.
          [-1.8083e-03, -1.9118e-03, -1.9522e-03, -1.9368e-03, -1.8549e-03],.
          [-1.6304e-03, -1.7345e-03, -1.7657e-03, -1.7386e-03, -1.6200e-03],.
          [-1.7026e-03, -1.7926e-03, -1.7380e-03, -1.7767e-03, -1.7142e-03],.
          [-2.0392e-03, -1.9824e-03, -1.8618e-03, -1.7328e-03, -1.7581e-03]].,.
         [[-9.4622e-07, -6.4522e-06, -3.6284e-05, -2.1018e-05, -3.0495e-05],.
          [-2.3618e-06,  2.9281e-06, -3.8929e-05, -7.4476e-05, -6.6130e-05],.
          [-1.3638e-04, -1.2421e-04, -1.1444e-04, -1.5131e-04, -1.3190e-04],.
          [-2.8180e-04, -3.1551e-04, -2.5374e-04, -2.0839e-04, -1.9536e-04],.
          [-2.2548e-04, -2.2115e-04, -1.8897e-04, -1.5856e-04, -1.5426e-04]].,.
         [[-3.6321e-04, -2.2590e-04, -1.6744e-04, -2.6003e-04, -2.1764e-04],.
          [-3.4739e-04, -3.3325e-04, -2.7005e-04, -2.1798e-04, -3.8100e-04],.
          [-6.7198e-04, -6.6803e-04, -7.4156e-04, -6.6040e-04, -4.8972e-04],.
          [-6.0286e-04, -5.6799e-04, -6.0796e-04, -6.6068e-04, -4.3105e-04],.
          [-2.2537e-04, -3.0361e-04, -1.7491e-04, -1.4177e-04, -1.4259e-04]].,.
         [[-8.1658e-05,  1.4938e-06,  1.0246e-04,  1.6278e-04,  1.7771e-04],.
          [-6.9262e-05, -7.1745e-05,  3.9395e-05,  1.5380e-04,  1.9997e-04],.
          [ 1.3633e-04,  1.3511e-04,  1.1189e-04,  1.8795e-04,  2.4508e-04],.
          [ 1.1212e-04,  1.0932e-04,  3.7396e-05, -1.5374e-05, -7.1377e-06],.
          [-2.3847e-04, -3.0182e-04, -3.3326e-04, -3.5610e-04, -3.0521e-04]].,.
         [[ 5.9808e-04,  7.5739e-04,  8.5681e-04,  7.3669e-04,  7.3773e-04],.
          [ 6.0682e-04,  8.3346e-04,  7.9430e-04,  5.6829e-04,  4.8939e-04],.
          [ 3.0029e-04,  3.9693e-04,  3.4455e-04,  2.7467e-04,  1.6976e-04],.
          [ 1.0103e-04,  1.5007e-04,  1.7154e-04,  2.2765e-04,  2.1945e-04],.
          [ 3.2108e-04,  3.5550e-04,  4.5390e-04,  4.9424e-04,  4.6988e-04]].].,
        [[[ 6.7819e-04,  6.4636e-04,  7.3011e-04,  7.7142e-04,  7.7453e-04],.
          [ 6.6938e-04,  8.2107e-04,  8.2409e-04,  7.8655e-04,  7.9590e-04],.
          [ 7.0465e-04,  7.7025e-04,  7.5833e-04,  7.7494e-04,  8.7968e-04],.
          [ 5.0863e-04,  6.0506e-04,  6.9001e-04,  7.2078e-04,  7.7138e-04],.
          [ 3.0813e-04,  3.6632e-04,  5.2058e-04,  4.7129e-04,  5.0751e-04]].,.
         [[ 1.9753e-03,  1.9616e-03,  2.0263e-03,  2.1135e-03,  2.1350e-03],.
          [ 1.9412e-03,  2.1224e-03,  2.2563e-03,  2.3351e-03,  2.3006e-03],.
          [ 2.3082e-03,  2.4869e-03,  2.3759e-03,  2.3714e-03,  2.4134e-03],.
          [ 2.1742e-03,  2.1575e-03,  2.2646e-03,  2.3294e-03,  2.3494e-03],.
          [ 1.9487e-03,  2.0904e-03,  2.2591e-03,  2.3720e-03,  2.3882e-03]].,.
         [[ 1.0400e-04,  1.4450e-04,  2.0401e-04,  2.2132e-04,  2.3237e-04],.
          [ 1.3011e-04,  1.8668e-04,  2.2094e-04,  2.2764e-04,  2.4634e-04],.
          [ 7.1939e-05,  1.2018e-04,  1.2938e-04,  1.0622e-04,  1.3923e-04],.
          [ 8.0626e-05,  7.8075e-05,  9.4213e-05,  7.9416e-05,  5.5697e-05],.
          [ 8.4251e-05,  9.0843e-05,  6.0789e-05,  4.2498e-05, -8.5644e-06]].,.
         [[ 4.1056e-04,  5.2530e-04,  7.5478e-04,  7.3252e-04,  7.7592e-04],.
          [ 3.9540e-04,  3.7509e-04,  4.2847e-04,  5.5998e-04,  4.8736e-04],.
          [ 3.7130e-04,  3.4536e-04,  2.9062e-04,  5.0063e-04,  5.0859e-04],.
          [ 3.8055e-04,  5.1775e-04,  5.8796e-04,  6.5540e-04,  6.1011e-04],.
          [ 1.5585e-04,  2.3101e-04,  2.0838e-04,  1.7193e-04,  1.3092e-04]].,.
         [[-3.9245e-04, -5.2403e-04, -4.9563e-04, -3.8760e-04, -3.5080e-04],.
          [-4.2112e-04, -4.4237e-04, -4.3125e-04, -2.0666e-04, -1.8644e-04],.
          [-2.4898e-04, -1.3614e-04, -2.0624e-04, -1.1110e-04,  7.4908e-05],.
          [-2.5005e-04, -2.4242e-04, -3.1681e-04, -2.2408e-04, -4.1425e-06],.
          [-2.2057e-04, -2.3555e-04, -1.8238e-04,  9.6671e-06,  2.0328e-04]].,.
         [[-1.1098e-03, -9.4549e-04, -8.6142e-04, -7.9752e-04, -5.8810e-04],.
          [-1.0370e-03, -1.0824e-03, -1.0268e-03, -1.1368e-03, -9.3099e-04],.
          [-1.0540e-03, -1.2319e-03, -1.2035e-03, -1.1656e-03, -1.2493e-03],.
          [-8.4296e-04, -8.7446e-04, -9.9508e-04, -1.0049e-03, -1.1031e-03],.
          [-8.2961e-04, -8.5366e-04, -1.0386e-03, -1.2194e-03, -1.1050e-03]].].,
        [[[ 1.2038e-03,  1.1893e-03,  1.0372e-03,  9.4838e-04,  9.5047e-04],.
          [ 9.8797e-04,  9.3791e-04,  8.3657e-04,  8.5375e-04,  7.5412e-04],.
          [ 6.0665e-04,  6.2191e-04,  6.4245e-04,  4.9575e-04,  6.5190e-04],.
          [ 4.1902e-04,  4.7678e-04,  4.6167e-04,  4.6178e-04,  4.7279e-04],.
          [ 2.1978e-04,  3.0844e-04,  3.1317e-04,  3.2957e-04,  2.9800e-04]].,.
         [[ 3.3957e-03,  3.4592e-03,  3.4151e-03,  3.4197e-03,  3.3759e-03],.
          [ 3.5455e-03,  3.6116e-03,  3.4806e-03,  3.3915e-03,  3.0907e-03],.
          [ 3.1458e-03,  3.0635e-03,  2.8700e-03,  2.6674e-03,  2.6126e-03],.
          [ 2.4704e-03,  2.3384e-03,  2.1430e-03,  2.1780e-03,  2.2178e-03],.
          [ 1.7779e-03,  1.7717e-03,  1.7606e-03,  1.6743e-03,  1.5917e-03]].,.
         [[ 1.6754e-04,  2.2229e-04,  2.6000e-04,  2.4957e-04,  2.4195e-04],.
          [ 9.2234e-05,  1.3067e-04,  1.3197e-04,  1.5278e-04,  1.6198e-04],.
          [ 9.8780e-05,  1.0260e-04,  1.1564e-04,  9.3274e-05,  8.2478e-05],.
          [ 1.2489e-04,  9.8336e-05,  9.4756e-05,  8.3573e-05,  9.5918e-05],.
          [ 2.2943e-04,  1.5665e-04,  1.1984e-04,  1.4627e-04,  1.5598e-04]].,.
         [[ 9.4543e-04,  8.5846e-04,  8.2712e-04,  8.8285e-04,  8.6374e-04],.
          [ 8.4270e-04,  7.9790e-04,  7.9976e-04,  6.7746e-04,  6.5519e-04],.
          [ 6.4640e-04,  5.7816e-04,  6.2751e-04,  7.3241e-04,  6.4247e-04],.
          [ 8.5484e-04,  6.9478e-04,  5.9333e-04,  5.5002e-04,  5.9455e-04],.
          [ 7.8016e-04,  6.7322e-04,  5.8459e-04,  4.2341e-04,  4.5132e-04]].,.
         [[ 7.8649e-04,  7.5771e-04,  8.0464e-04,  8.5495e-04,  9.0513e-04],.
          [ 1.1853e-03,  1.2576e-03,  1.2689e-03,  1.2759e-03,  1.1892e-03],.
          [ 1.4037e-03,  1.3728e-03,  1.1994e-03,  1.1051e-03,  1.0303e-03],.
          [ 1.0489e-03,  1.0623e-03,  8.7424e-04,  8.8195e-04,  9.5754e-04],.
          [ 6.1356e-04,  7.0052e-04,  7.3030e-04,  7.4425e-04,  6.8369e-04]].,.
         [[ 3.3759e-05,  6.0506e-05,  1.3630e-04,  1.3336e-04,  2.0184e-04],.
          [ 4.4525e-05, -2.0705e-05,  4.1470e-05,  5.5647e-05,  1.4504e-04],.
          [ 7.8529e-05,  5.7556e-05,  9.6057e-05,  1.8604e-04,  2.2729e-04],.
          [ 4.1109e-04,  3.4217e-04,  2.8845e-04,  3.2457e-04,  2.6726e-04],.
          [ 6.9151e-04,  5.9125e-04,  5.1237e-04,  4.6078e-04,  5.0100e-04]].].,
        ...,.
        [[[ 4.6553e-04,  4.5442e-04,  5.6195e-04,  4.6995e-04,  4.5341e-04],.
          [ 4.0204e-04,  4.2130e-04,  5.4684e-04,  5.5798e-04,  4.0573e-04],.
          [ 3.3910e-04,  3.7648e-04,  5.2342e-04,  5.6720e-04,  3.5032e-04],.
          [ 2.7529e-04,  2.9042e-04,  4.9088e-04,  4.7929e-04,  3.1423e-04],.
          [ 2.2377e-04,  3.1435e-04,  3.9541e-04,  3.7031e-04,  2.7882e-04]].,.
         [[ 1.0473e-03,  1.0639e-03,  1.0983e-03,  9.9878e-04,  1.0244e-03],.
          [ 1.1902e-03,  1.1991e-03,  1.2793e-03,  1.1590e-03,  1.1273e-03],.
          [ 1.2280e-03,  1.2077e-03,  1.2534e-03,  1.2461e-03,  1.1516e-03],.
          [ 1.2013e-03,  1.1953e-03,  1.2893e-03,  1.2810e-03,  1.1994e-03],.
          [ 1.2346e-03,  1.1623e-03,  1.2537e-03,  1.2154e-03,  1.2139e-03]].,.
         [[ 1.2076e-05, -8.4280e-06, -1.3411e-07,  1.4445e-05, -5.3501e-05],.
          [ 1.3806e-05, -2.1977e-05, -2.7880e-05,  3.0480e-05, -3.6879e-05],.
          [ 6.2436e-06, -2.3812e-05, -3.3579e-05,  7.1990e-05,  2.5949e-05],.
          [ 1.9252e-05, -2.0547e-05, -4.6048e-05,  2.5302e-05,  2.7701e-05],.
          [-1.9820e-05, -5.9851e-05, -9.4578e-05, -4.9233e-05, -3.3360e-05]].,.
         [[ 2.7709e-04,  2.5231e-04,  9.1787e-05,  1.2717e-04,  2.2188e-04],.
          [ 1.4155e-04,  1.4740e-04,  1.6637e-04,  4.3748e-05,  1.9759e-04],.
          [ 1.4248e-04,  2.2078e-04,  2.4880e-04,  1.1950e-04,  2.4228e-04],.
          [ 1.8083e-05,  2.2915e-04,  2.7869e-04,  1.2863e-04,  1.1839e-04],.
          [ 1.7850e-04,  2.1411e-04,  3.2268e-04,  1.3324e-04,  1.2630e-04]].,.
         [[-1.4305e-06,  6.5327e-05,  1.0222e-04,  1.5490e-05, -5.4818e-06],.
          [ 2.1452e-04,  2.5241e-04,  3.3125e-04,  1.4798e-04,  1.0153e-04],.
          [ 3.3625e-04,  3.6592e-04,  4.5146e-04,  2.8509e-04,  7.0879e-05],.
          [ 3.6564e-04,  3.7877e-04,  5.5174e-04,  4.8108e-04,  2.6217e-04],.
          [ 4.3749e-04,  4.7102e-04,  6.5718e-04,  5.8078e-04,  4.1686e-04]].,.
         [[-1.4421e-04, -2.9223e-04, -2.3664e-04, -1.3052e-04, -2.8881e-04],.
          [-2.7755e-04, -3.5578e-04, -3.0946e-04, -1.8482e-04, -2.3547e-04],.
          [-2.2470e-04, -2.2640e-04, -2.4643e-04, -1.6779e-04,  4.5337e-06],.
          [-1.6897e-04, -1.4505e-04, -2.5560e-04, -3.1208e-04, -1.2513e-04],.
          [-2.7219e-04, -1.5667e-04, -3.0050e-04, -3.5986e-04, -2.5458e-04]].].,
        [[[ 5.9158e-06, -8.6054e-07,  6.5919e-06,  7.7747e-06,  1.1399e-06],.
          [ 2.1495e-06,  1.2730e-06,  2.3954e-06,  5.5358e-06,  3.1963e-06],.
          [ 9.7789e-07,  6.5565e-07, -3.5018e-07,  2.0266e-06,  3.7774e-06],.
          [-5.6624e-07, -1.1995e-06, -2.4028e-06,  2.4438e-06,  3.5372e-06],.
          [ 3.0212e-06,  2.4959e-07, -1.0207e-06, -1.4305e-06,  2.9318e-06]].,.
         [[ 1.8814e-05,  1.4257e-05,  1.7777e-05,  1.6827e-05,  1.8976e-05],.
          [ 1.5946e-05,  1.1886e-05,  9.5665e-06,  9.9447e-06,  8.5905e-06],.
          [ 1.4786e-05,  5.7044e-06,  2.7791e-06,  1.0341e-05,  4.9453e-06],.
          [ 9.4883e-06,  1.7881e-06,  6.0126e-06,  7.4003e-06,  1.1852e-05],.
          [ 1.0196e-05, -5.7044e-07,  1.8775e-06,  2.2762e-06,  6.6236e-06]].,.
         [[ 2.5716e-06, -8.9407e-08, -1.1101e-06,  3.3714e-07, -2.0862e-06],.
          [ 1.1921e-06,  3.3155e-07,  2.3842e-07, -1.6764e-06,  7.2271e-07],.
          [ 4.0233e-06,  1.2405e-06, -2.0694e-06, -3.0175e-06,  9.6485e-07],.
          [ 8.7917e-06,  2.7157e-06,  2.4913e-07, -1.5311e-06, -1.7136e-07],.
          [ 8.7470e-06,  4.8596e-06,  4.2096e-06,  3.8370e-07, -1.5497e-06]].,.
         [[ 4.3213e-07,  6.7391e-06,  7.4953e-06,  2.2091e-06,  5.0589e-06],.
          [ 3.0370e-06,  3.2112e-06,  7.3500e-06,  4.7199e-06, -6.9570e-07],.
          [ 9.1568e-06,  1.0487e-05,  9.1419e-06,  9.8767e-06, -2.3581e-06],.
          [-2.7772e-06,  6.4559e-06,  9.0189e-06,  1.3679e-05, -2.7008e-06],.
          [ 4.6045e-06,  2.9802e-06,  7.0557e-06,  1.8062e-05,  2.1530e-05]].,.
          [-5.4911e-06, -6.8322e-06,  1.0226e-06,  1.8805e-05,  9.2573e-06],.
          [-3.3602e-06, -6.1207e-06, -5.8562e-06,  7.2420e-06,  9.5991e-06],.
          [-2.1234e-06, -9.2131e-06, -9.3803e-06, -3.2857e-06,  1.8068e-06]].,.
         [[ 3.9618e-06,  5.7966e-06,  5.4799e-06,  6.5756e-06,  1.0327e-05],.
          [ 6.1840e-07,  4.7125e-06,  2.2650e-06,  4.2841e-06,  9.0748e-06],.
          [ 6.7540e-06,  6.0927e-06,  5.7984e-06,  8.2329e-07,  1.1083e-06],.
          [ 1.4462e-05,  1.4350e-05,  6.3553e-06,  3.4682e-06, -6.4075e-06],.
          [ 8.2832e-06,  1.8138e-05,  1.7002e-05,  2.1316e-05,  1.3053e-05]].].,
        [[[ 6.0759e-06,  1.2703e-06,  1.4566e-06,  5.9349e-07, -3.0484e-05],.
          [ 8.9128e-07,  1.0431e-07,  4.6566e-07, -2.3991e-06, -3.6467e-05],.
          [ 5.6000e-06, -3.6582e-06, -2.9393e-06, -1.8096e-05, -3.3300e-05],.
          [ 6.0275e-06, -1.0154e-05, -2.5801e-05, -4.4640e-05, -4.9021e-05],.
          [ 2.4140e-06, -2.9360e-05, -4.3897e-05, -4.7520e-05, -4.4497e-05]].,.
         [[-2.5107e-05,  1.3058e-05,  2.6226e-05, -5.1484e-06, -5.0552e-06],.
          [-1.7785e-05,  2.2911e-05,  3.1631e-05,  1.2945e-05,  6.1998e-06],.
          [-1.9969e-05,  1.9386e-05,  3.0935e-05,  2.3551e-05, -1.0673e-06],.
          [ 7.5307e-06,  1.8857e-05,  7.4469e-06, -1.6890e-05, -2.6315e-05],.
          [ 3.7365e-05,  2.8867e-05,  1.2012e-05, -5.0217e-06, -1.9737e-05]].,.
         [[ 4.6790e-06,  1.5870e-06, -1.9122e-06,  2.8582e-06, -1.1602e-05],.
          [ 4.7442e-06,  6.9290e-06,  6.1095e-07, -9.0078e-06, -3.8520e-06],.
          [ 2.4290e-05,  2.2174e-05,  1.1630e-05, -1.1291e-05,  1.2171e-05],.
          [ 2.6161e-05,  4.1571e-05,  5.5730e-05,  1.7833e-05,  2.7493e-05],.
          [-5.5432e-06, -1.7500e-06,  1.0585e-05,  1.2681e-05,  9.5563e-06]].,.
         [[-1.8567e-05, -8.3074e-07, -7.4878e-06, -5.0221e-05, -2.2938e-05],.
          [-2.1480e-05,  3.4173e-05,  4.7944e-06, -4.1056e-05, -8.3670e-05],.
          [-9.0711e-06,  3.7812e-05,  3.9192e-05,  1.7319e-05, -8.0161e-05],.
          [-2.6062e-05,  7.7486e-06, -1.2180e-05, -1.4707e-05, -3.1032e-05],.
          [-6.6865e-05, -5.8104e-05, -4.7207e-05, -6.1452e-05, -6.8678e-05]].,.
         [[-1.0278e-05, -6.6143e-06, -7.4245e-06, -1.8407e-05, -6.2134e-05],.
          [-1.5967e-05, -1.1018e-05, -1.0037e-06, -2.6673e-06, -4.0412e-05],.
          [-1.2938e-05, -1.7211e-05, -4.5933e-06, -3.6657e-06, -3.9186e-05],.
          [ 2.5235e-05,  8.4597e-06,  3.8743e-06, -8.6837e-06, -2.6498e-05],.
          [ 5.0485e-05,  2.3201e-05,  7.4282e-06,  4.4075e-07, -1.1649e-05]].,.
         [[-1.8257e-04, -1.9757e-04, -1.9773e-04, -1.5651e-04, -1.4299e-04],.
          [-1.4981e-04, -9.6899e-05, -1.4102e-04, -1.9650e-04, -1.9540e-04],.
          [-4.2990e-05,  1.0766e-05, -4.3470e-05, -1.3883e-04, -1.2934e-04],.
          [-3.8852e-05, -2.7265e-05, -2.0484e-05, -1.1764e-05, -3.8035e-05],.         
          [-3.8852e-05, -2.7265e-05, -2.0484e-05, -1.1764e-05, -3.8035e-05],."""


def client_trn_loop(i):
    HOST = '127.0.0.1'  # 服务器的主机名或者 IP 地址
    PORT = 65432        # 服务器使用的端口
    
    while True:
        print("new loop..")
        with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
            s.connect((HOST, PORT))
            data = pickle.dumps(model)
            s.sendall(data)
            data = s.recv(1024)
            print(i, ' - Received', repr(data))
            print("================")
    

def ser():
    HOST = '127.0.0.1'  # 标准的回环地址 (localhost)
    PORT = 23456        # 监听的端口 (非系统级的端口: 大于 1023)

    with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
        print(s.gettimeout())
        s.bind((HOST, PORT))
        s.listen()
        while True:
            print("listening...")
            conn, addr = s.accept()
            recv_data = b""
            with conn:
                print('Connected by', addr)
                while True:
                    print("-->")
                    data = conn.recv(1024)
                    print("<--")
                    if not data:
                        break
                    recv_data += data
                    print("================")
                    print(data)
                    if str(data)[-2] == '.':
                        break
                #print("sendind ACKACKAACK")
                conn.sendall(b"ACKACKAACK!!!")




try:
    a = Thread(name="aaa", target=client_trn_loop, args=('1'))
    a.start()
    b = Thread(name="bbb", target=client_trn_loop, args=('2'))
    b.start()
    ss = Thread(name="sss", target=ser)
    ss.start()
except (KeyboardInterrupt, SystemExit):
    print("Gracefully shutting client down...")
finally:
    a.join()
    b.join()
    ss.join()




